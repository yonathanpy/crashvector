from config import RISK_WEIGHTS

def calculate_score(patterns, protections):
    score = 0

    for p in patterns:
        score += RISK_WEIGHTS.get(p, 0)

    if not protections.get("canary"):
        score += RISK_WEIGHTS["missing_canary"]

    if not protections.get("nx"):
        score += RISK_WEIGHTS["missing_nx"]

    if not protections.get("pie"):
        score += RISK_WEIGHTS["missing_pie"]

    if score >= 8:
        return "HIGH"
    if score >= 4:
        return "MEDIUM"
    return "LOW"
